[gd_scene load_steps=24 format=3 uid="uid://bdpl8fli78bpl"]

[ext_resource type="PackedScene" uid="uid://d2gb1ghqqi51h" path="res://assets/Man/Man.glb" id="1_ugvvu"]
[ext_resource type="Script" uid="uid://cir1p5t6vqime" path="res://scripts/player.gd" id="2_pfr4v"]
[ext_resource type="PackedScene" uid="uid://dx6t2o007wevr" path="res://sword.tscn" id="3_rb5kw"]
[ext_resource type="Script" uid="uid://twu7qkx6ixkt" path="res://scripts/weapon_hitbox.gd" id="4_dqn0h"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_rb5kw"]
radius = 0.2
height = 1.4

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_6hl5u"]
animation = &"attack1"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_gca12"]
animation = &"idle"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_2x0nd"]
animation = &"run"

[sub_resource type="AnimationNodeBlendSpace1D" id="AnimationNodeBlendSpace1D_ml447"]
blend_point_0/node = SubResource("AnimationNodeAnimation_gca12")
blend_point_0/pos = 0.0
blend_point_1/node = SubResource("AnimationNodeAnimation_2x0nd")
blend_point_1/pos = 1.0
min_space = 0.0

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_ml447"]
animation = &"run"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_m6ldf"]
animation = &"slide"

[sub_resource type="AnimationNodeBlendSpace1D" id="AnimationNodeBlendSpace1D_xmkcg"]
blend_point_0/node = SubResource("AnimationNodeAnimation_ml447")
blend_point_0/pos = 0.0
blend_point_1/node = SubResource("AnimationNodeAnimation_m6ldf")
blend_point_1/pos = 1.0
min_space = 0.0

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_dqn0h"]
animation = &"slide_attack"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_rb5kw"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_dqn0h"]
xfade_time = 0.01
advance_mode = 2
advance_condition = &"attack"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_gca12"]
xfade_time = 0.01
switch_mode = 2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_e85lc"]
switch_mode = 2
advance_mode = 2
advance_condition = &"not_sliding"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_pdy8h"]
advance_mode = 2
advance_condition = &"sliding"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_2x0nd"]
advance_mode = 2
advance_condition = &"slide_attack"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_ml447"]
switch_mode = 2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_m6ldf"]
states/End/position = Vector2(635, 100)
states/Start/position = Vector2(199, 100)
states/attack1/node = SubResource("AnimationNodeAnimation_6hl5u")
states/attack1/position = Vector2(357, 189)
states/run/node = SubResource("AnimationNodeBlendSpace1D_ml447")
states/run/position = Vector2(357, 100)
states/slide/node = SubResource("AnimationNodeBlendSpace1D_xmkcg")
states/slide/position = Vector2(518.21094, 100)
states/slide_attack/node = SubResource("AnimationNodeAnimation_dqn0h")
states/slide_attack/position = Vector2(518.21094, 189)
transitions = ["Start", "run", SubResource("AnimationNodeStateMachineTransition_rb5kw"), "run", "attack1", SubResource("AnimationNodeStateMachineTransition_dqn0h"), "attack1", "run", SubResource("AnimationNodeStateMachineTransition_gca12"), "slide", "run", SubResource("AnimationNodeStateMachineTransition_e85lc"), "run", "slide", SubResource("AnimationNodeStateMachineTransition_pdy8h"), "slide", "slide_attack", SubResource("AnimationNodeStateMachineTransition_2x0nd"), "slide_attack", "slide", SubResource("AnimationNodeStateMachineTransition_ml447")]
graph_offset = Vector2(43.210922, 24)

[sub_resource type="AnimationNodeBlendTree" id="AnimationNodeBlendTree_2x0nd"]
graph_offset = Vector2(-637.34265, 71.87747)
nodes/StateMachine/node = SubResource("AnimationNodeStateMachine_m6ldf")
nodes/StateMachine/position = Vector2(-180, 100)
node_connections = [&"output", 0, &"StateMachine"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_ml447"]

[node name="Man" instance=ExtResource("1_ugvvu")]
script = ExtResource("2_pfr4v")

[node name="Skeleton3D" parent="Armature" index="0"]
unique_name_in_owner = true
bones/0/position = Vector3(0, 1.0175732, 2.9015308e-09)
bones/0/rotation = Quaternion(-0.021824481, 0, 0, 0.9997618)
bones/1/rotation = Quaternion(0.13163112, 1.1817205e-07, 1.5691658e-08, 0.9912988)
bones/2/rotation = Quaternion(-0.12310755, 0.005370846, 0.9741697, -0.18923353)
bones/3/rotation = Quaternion(0.08954688, -0.00439433, -0.015656726, 0.99584985)
bones/5/rotation = Quaternion(0.0027450193, 0.03458613, 0.99573046, -0.085540295)
bones/5/scale = Vector3(1.0000538, 0.9999992, 1.0000136)
bones/6/rotation = Quaternion(-0.16101222, 0.00089072145, -0.099444345, 0.98192924)
bones/6/scale = Vector3(0.99999976, 1.0000004, 1)
bones/7/rotation = Quaternion(0.64474684, 0.097152494, 0.07330508, 0.7546452)
bones/7/scale = Vector3(1.0000067, 1.0000116, 1.0000033)
bones/8/rotation = Quaternion(0.09498753, 0.0023067447, 0.97800297, 0.18569387)
bones/9/rotation = Quaternion(0.08954689, 0.0043943394, 0.015656741, 0.99584985)
bones/10/rotation = Quaternion(0.12137333, -0.0727763, 0.11195846, 0.983584)
bones/11/rotation = Quaternion(-0.0027450044, 0.03458613, 0.99573046, 0.085540295)
bones/11/scale = Vector3(1.0000538, 0.9999992, 1.0000136)
bones/12/rotation = Quaternion(-0.16101222, -0.0008907219, 0.099444345, 0.98192924)
bones/13/rotation = Quaternion(0.64474684, -0.09715248, -0.073305085, 0.7546452)
bones/13/scale = Vector3(1.0000067, 1.0000116, 1.0000032)

[node name="head" type="BoneAttachment3D" parent="Armature/Skeleton3D" index="1"]
transform = Transform3D(1, -3.5527137e-15, 2.3841864e-07, 5.2117503e-08, 0.97581536, -0.2185966, -2.3265257e-07, 0.2185966, 0.97581536, 0, 1.5999663, -0.02543903)
bone_name = "head"
bone_idx = 1

[node name="Camera_container" type="Node3D" parent="Armature/Skeleton3D/head" index="0"]
transform = Transform3D(-1, -3.5527137e-14, -8.7422904e-08, 0, 0.9999995, 1.4901161e-08, 8.742276e-08, 1.4901161e-08, -0.9999995, -3.6332217e-08, 0.19551933, 0.1523882)

[node name="Player_camera" type="Camera3D" parent="Armature/Skeleton3D/head/Camera_container" index="0"]

[node name="right_hand" type="BoneAttachment3D" parent="Armature/Skeleton3D" index="2"]
transform = Transform3D(-0.9116275, -0.0065829866, 0.41096705, 0.17338859, -0.9127094, 0.36999702, 0.37265784, 0.4085558, 0.8331917, -0.38325393, 0.9742302, 0.061318815)
bone_name = "hand.r"
bone_idx = 10

[node name="Weapon_container" type="Node3D" parent="Armature/Skeleton3D/right_hand" index="0"]
transform = Transform3D(0.26686257, 0.5162382, 0.81380534, 0.9634385, -0.16383183, -0.21200277, 0.023883492, 0.84062904, -0.54108423, -0.07246739, 0.09989506, -0.13917859)

[node name="sword" parent="Armature/Skeleton3D/right_hand/Weapon_container" index="0" instance=ExtResource("3_rb5kw")]

[node name="weapon_hitbox" type="Area3D" parent="Armature/Skeleton3D/right_hand/Weapon_container/sword" index="1"]
transform = Transform3D(1, 2.9802322e-08, -7.450581e-09, 2.9802322e-08, 1, 1.4901161e-08, 0, 0, 1, 0, 0, 0)
script = ExtResource("4_dqn0h")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Armature/Skeleton3D/right_hand/Weapon_container/sword/weapon_hitbox" index="0"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.56, 0)
shape = SubResource("CapsuleShape3D_rb5kw")
disabled = true

[node name="AnimationTree" type="AnimationTree" parent="." index="2"]
tree_root = SubResource("AnimationNodeBlendTree_2x0nd")
advance_expression_base_node = NodePath("..")
anim_player = NodePath("../AnimationPlayer")
parameters/StateMachine/conditions/attack = false
parameters/StateMachine/conditions/not_sliding = false
parameters/StateMachine/conditions/slide_attack = false
parameters/StateMachine/conditions/sliding = false
parameters/StateMachine/run/blend_position = 0.0
parameters/StateMachine/slide/blend_position = 0.0

[node name="Hitbox" type="CollisionShape3D" parent="." index="3"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
shape = SubResource("CapsuleShape3D_ml447")
